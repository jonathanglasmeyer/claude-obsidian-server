"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@ai-sdk+gateway@1.0.15_zod@4.1.5";
exports.ids = ["vendor-chunks/@ai-sdk+gateway@1.0.15_zod@4.1.5"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@ai-sdk+gateway@1.0.15_zod@4.1.5/node_modules/@ai-sdk/gateway/dist/index.mjs":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@ai-sdk+gateway@1.0.15_zod@4.1.5/node_modules/@ai-sdk/gateway/dist/index.mjs ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GatewayAuthenticationError: () => (/* binding */ GatewayAuthenticationError),\n/* harmony export */   GatewayError: () => (/* binding */ GatewayError),\n/* harmony export */   GatewayInternalServerError: () => (/* binding */ GatewayInternalServerError),\n/* harmony export */   GatewayInvalidRequestError: () => (/* binding */ GatewayInvalidRequestError),\n/* harmony export */   GatewayModelNotFoundError: () => (/* binding */ GatewayModelNotFoundError),\n/* harmony export */   GatewayRateLimitError: () => (/* binding */ GatewayRateLimitError),\n/* harmony export */   GatewayResponseError: () => (/* binding */ GatewayResponseError),\n/* harmony export */   createGateway: () => (/* binding */ createGatewayProvider),\n/* harmony export */   createGatewayProvider: () => (/* binding */ createGatewayProvider),\n/* harmony export */   gateway: () => (/* binding */ gateway)\n/* harmony export */ });\n/* harmony import */ var _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @ai-sdk/provider */ \"(ssr)/./node_modules/.pnpm/@ai-sdk+provider@2.0.0/node_modules/@ai-sdk/provider/dist/index.mjs\");\n/* harmony import */ var _ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ai-sdk/provider-utils */ \"(ssr)/./node_modules/.pnpm/@ai-sdk+provider-utils@3.0.7_zod@4.1.5/node_modules/@ai-sdk/provider-utils/dist/index.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod/v4 */ \"(ssr)/./node_modules/.pnpm/zod@4.1.5/node_modules/zod/v4/classic/schemas.js\");\n// src/gateway-provider.ts\n\n\n\n// src/errors/as-gateway-error.ts\n\n\n// src/errors/create-gateway-error.ts\n\n\n// src/errors/gateway-error.ts\nvar marker = \"vercel.ai.gateway.error\";\nvar symbol = Symbol.for(marker);\nvar _a, _b;\nvar GatewayError = class _GatewayError extends (_b = Error, _a = symbol, _b) {\n  constructor({\n    message,\n    statusCode = 500,\n    cause\n  }) {\n    super(message);\n    this[_a] = true;\n    this.statusCode = statusCode;\n    this.cause = cause;\n  }\n  /**\n   * Checks if the given error is a Gateway Error.\n   * @param {unknown} error - The error to check.\n   * @returns {boolean} True if the error is a Gateway Error, false otherwise.\n   */\n  static isInstance(error) {\n    return _GatewayError.hasMarker(error);\n  }\n  static hasMarker(error) {\n    return typeof error === \"object\" && error !== null && symbol in error && error[symbol] === true;\n  }\n};\n\n// src/errors/gateway-authentication-error.ts\nvar name = \"GatewayAuthenticationError\";\nvar marker2 = `vercel.ai.gateway.error.${name}`;\nvar symbol2 = Symbol.for(marker2);\nvar _a2, _b2;\nvar GatewayAuthenticationError = class _GatewayAuthenticationError extends (_b2 = GatewayError, _a2 = symbol2, _b2) {\n  constructor({\n    message = \"Authentication failed\",\n    statusCode = 401,\n    cause\n  } = {}) {\n    super({ message, statusCode, cause });\n    this[_a2] = true;\n    // used in isInstance\n    this.name = name;\n    this.type = \"authentication_error\";\n  }\n  static isInstance(error) {\n    return GatewayError.hasMarker(error) && symbol2 in error;\n  }\n  /**\n   * Creates a contextual error message when authentication fails\n   */\n  static createContextualError({\n    apiKeyProvided,\n    oidcTokenProvided,\n    message = \"Authentication failed\",\n    statusCode = 401,\n    cause\n  }) {\n    let contextualMessage;\n    if (apiKeyProvided) {\n      contextualMessage = `AI Gateway authentication failed: Invalid API key provided.\n\nThe token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`;\n    } else if (oidcTokenProvided) {\n      contextualMessage = `AI Gateway authentication failed: Invalid OIDC token provided.\n\nThe token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.\n- make sure your Vercel project settings have OIDC enabled\n- if running locally with 'vercel dev', the token is automatically obtained and refreshed\n- if running locally with your own dev server, run 'vercel env pull' to fetch the token\n- in production/preview, the token is automatically obtained and refreshed\n\nAlternative: Provide an API key via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`;\n    } else {\n      contextualMessage = `AI Gateway authentication failed: No authentication provided.\n\nProvide either an API key or OIDC token.\n\nAPI key instructions:\n\nThe token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.\n\nOIDC token instructions:\n\nThe token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.\n- make sure your Vercel project settings have OIDC enabled\n- if running locally with 'vercel dev', the token is automatically obtained and refreshed\n- if running locally with your own dev server, run 'vercel env pull' to fetch the token\n- in production/preview, the token is automatically obtained and refreshed`;\n    }\n    return new _GatewayAuthenticationError({\n      message: contextualMessage,\n      statusCode,\n      cause\n    });\n  }\n};\n\n// src/errors/gateway-invalid-request-error.ts\nvar name2 = \"GatewayInvalidRequestError\";\nvar marker3 = `vercel.ai.gateway.error.${name2}`;\nvar symbol3 = Symbol.for(marker3);\nvar _a3, _b3;\nvar GatewayInvalidRequestError = class extends (_b3 = GatewayError, _a3 = symbol3, _b3) {\n  constructor({\n    message = \"Invalid request\",\n    statusCode = 400,\n    cause\n  } = {}) {\n    super({ message, statusCode, cause });\n    this[_a3] = true;\n    // used in isInstance\n    this.name = name2;\n    this.type = \"invalid_request_error\";\n  }\n  static isInstance(error) {\n    return GatewayError.hasMarker(error) && symbol3 in error;\n  }\n};\n\n// src/errors/gateway-rate-limit-error.ts\nvar name3 = \"GatewayRateLimitError\";\nvar marker4 = `vercel.ai.gateway.error.${name3}`;\nvar symbol4 = Symbol.for(marker4);\nvar _a4, _b4;\nvar GatewayRateLimitError = class extends (_b4 = GatewayError, _a4 = symbol4, _b4) {\n  constructor({\n    message = \"Rate limit exceeded\",\n    statusCode = 429,\n    cause\n  } = {}) {\n    super({ message, statusCode, cause });\n    this[_a4] = true;\n    // used in isInstance\n    this.name = name3;\n    this.type = \"rate_limit_exceeded\";\n  }\n  static isInstance(error) {\n    return GatewayError.hasMarker(error) && symbol4 in error;\n  }\n};\n\n// src/errors/gateway-model-not-found-error.ts\n\nvar name4 = \"GatewayModelNotFoundError\";\nvar marker5 = `vercel.ai.gateway.error.${name4}`;\nvar symbol5 = Symbol.for(marker5);\nvar modelNotFoundParamSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  modelId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar _a5, _b5;\nvar GatewayModelNotFoundError = class extends (_b5 = GatewayError, _a5 = symbol5, _b5) {\n  constructor({\n    message = \"Model not found\",\n    statusCode = 404,\n    modelId,\n    cause\n  } = {}) {\n    super({ message, statusCode, cause });\n    this[_a5] = true;\n    // used in isInstance\n    this.name = name4;\n    this.type = \"model_not_found\";\n    this.modelId = modelId;\n  }\n  static isInstance(error) {\n    return GatewayError.hasMarker(error) && symbol5 in error;\n  }\n};\n\n// src/errors/gateway-internal-server-error.ts\nvar name5 = \"GatewayInternalServerError\";\nvar marker6 = `vercel.ai.gateway.error.${name5}`;\nvar symbol6 = Symbol.for(marker6);\nvar _a6, _b6;\nvar GatewayInternalServerError = class extends (_b6 = GatewayError, _a6 = symbol6, _b6) {\n  constructor({\n    message = \"Internal server error\",\n    statusCode = 500,\n    cause\n  } = {}) {\n    super({ message, statusCode, cause });\n    this[_a6] = true;\n    // used in isInstance\n    this.name = name5;\n    this.type = \"internal_server_error\";\n  }\n  static isInstance(error) {\n    return GatewayError.hasMarker(error) && symbol6 in error;\n  }\n};\n\n// src/errors/gateway-response-error.ts\nvar name6 = \"GatewayResponseError\";\nvar marker7 = `vercel.ai.gateway.error.${name6}`;\nvar symbol7 = Symbol.for(marker7);\nvar _a7, _b7;\nvar GatewayResponseError = class extends (_b7 = GatewayError, _a7 = symbol7, _b7) {\n  constructor({\n    message = \"Invalid response from Gateway\",\n    statusCode = 502,\n    response,\n    validationError,\n    cause\n  } = {}) {\n    super({ message, statusCode, cause });\n    this[_a7] = true;\n    // used in isInstance\n    this.name = name6;\n    this.type = \"response_error\";\n    this.response = response;\n    this.validationError = validationError;\n  }\n  static isInstance(error) {\n    return GatewayError.hasMarker(error) && symbol7 in error;\n  }\n};\n\n// src/errors/create-gateway-error.ts\nfunction createGatewayErrorFromResponse({\n  response,\n  statusCode,\n  defaultMessage = \"Gateway request failed\",\n  cause,\n  authMethod\n}) {\n  const parseResult = gatewayErrorResponseSchema.safeParse(response);\n  if (!parseResult.success) {\n    return new GatewayResponseError({\n      message: `Invalid error response format: ${defaultMessage}`,\n      statusCode,\n      response,\n      validationError: parseResult.error,\n      cause\n    });\n  }\n  const validatedResponse = parseResult.data;\n  const errorType = validatedResponse.error.type;\n  const message = validatedResponse.error.message;\n  switch (errorType) {\n    case \"authentication_error\":\n      return GatewayAuthenticationError.createContextualError({\n        apiKeyProvided: authMethod === \"api-key\",\n        oidcTokenProvided: authMethod === \"oidc\",\n        statusCode,\n        cause\n      });\n    case \"invalid_request_error\":\n      return new GatewayInvalidRequestError({ message, statusCode, cause });\n    case \"rate_limit_exceeded\":\n      return new GatewayRateLimitError({ message, statusCode, cause });\n    case \"model_not_found\": {\n      const modelResult = modelNotFoundParamSchema.safeParse(\n        validatedResponse.error.param\n      );\n      return new GatewayModelNotFoundError({\n        message,\n        statusCode,\n        modelId: modelResult.success ? modelResult.data.modelId : void 0,\n        cause\n      });\n    }\n    case \"internal_server_error\":\n      return new GatewayInternalServerError({ message, statusCode, cause });\n    default:\n      return new GatewayInternalServerError({ message, statusCode, cause });\n  }\n}\nvar gatewayErrorResponseSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  error: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n    message: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n    type: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n    param: zod_v4__WEBPACK_IMPORTED_MODULE_0__.unknown().nullish(),\n    code: zod_v4__WEBPACK_IMPORTED_MODULE_0__.union([zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(), zod_v4__WEBPACK_IMPORTED_MODULE_0__.number()]).nullish()\n  })\n});\n\n// src/errors/as-gateway-error.ts\nfunction asGatewayError(error, authMethod) {\n  var _a8;\n  if (GatewayError.isInstance(error)) {\n    return error;\n  }\n  if (_ai_sdk_provider__WEBPACK_IMPORTED_MODULE_1__.APICallError.isInstance(error)) {\n    return createGatewayErrorFromResponse({\n      response: extractApiCallResponse(error),\n      statusCode: (_a8 = error.statusCode) != null ? _a8 : 500,\n      defaultMessage: \"Gateway request failed\",\n      cause: error,\n      authMethod\n    });\n  }\n  return createGatewayErrorFromResponse({\n    response: {},\n    statusCode: 500,\n    defaultMessage: error instanceof Error ? `Gateway request failed: ${error.message}` : \"Unknown Gateway error\",\n    cause: error,\n    authMethod\n  });\n}\n\n// src/errors/extract-api-call-response.ts\nfunction extractApiCallResponse(error) {\n  if (error.data !== void 0) {\n    return error.data;\n  }\n  if (error.responseBody != null) {\n    try {\n      return JSON.parse(error.responseBody);\n    } catch (e) {\n      return error.responseBody;\n    }\n  }\n  return {};\n}\n\n// src/errors/parse-auth-method.ts\n\nvar GATEWAY_AUTH_METHOD_HEADER = \"ai-gateway-auth-method\";\nfunction parseAuthMethod(headers) {\n  const result = gatewayAuthMethodSchema.safeParse(\n    headers[GATEWAY_AUTH_METHOD_HEADER]\n  );\n  return result.success ? result.data : void 0;\n}\nvar gatewayAuthMethodSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.union([\n  zod_v4__WEBPACK_IMPORTED_MODULE_0__.literal(\"api-key\"),\n  zod_v4__WEBPACK_IMPORTED_MODULE_0__.literal(\"oidc\")\n]);\n\n// src/gateway-fetch-metadata.ts\n\n\nvar GatewayFetchMetadata = class {\n  constructor(config) {\n    this.config = config;\n  }\n  async getAvailableModels() {\n    try {\n      const { value } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.getFromApi)({\n        url: `${this.config.baseURL}/config`,\n        headers: await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.resolve)(this.config.headers()),\n        successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.createJsonResponseHandler)(\n          gatewayFetchMetadataSchema\n        ),\n        failedResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.createJsonErrorResponseHandler)({\n          errorSchema: zod_v4__WEBPACK_IMPORTED_MODULE_0__.any(),\n          errorToMessage: (data) => data\n        }),\n        fetch: this.config.fetch\n      });\n      return value;\n    } catch (error) {\n      throw asGatewayError(error);\n    }\n  }\n};\nvar gatewayLanguageModelSpecificationSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  specificationVersion: zod_v4__WEBPACK_IMPORTED_MODULE_0__.literal(\"v2\"),\n  provider: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  modelId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nvar gatewayLanguageModelPricingSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  input: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  output: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  input_cache_read: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  input_cache_write: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n}).transform(({ input, output, input_cache_read, input_cache_write }) => ({\n  input,\n  output,\n  ...input_cache_read ? { cachedInputTokens: input_cache_read } : {},\n  ...input_cache_write ? { cacheCreationInputTokens: input_cache_write } : {}\n}));\nvar gatewayLanguageModelEntrySchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  name: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  description: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  pricing: gatewayLanguageModelPricingSchema.nullish(),\n  specification: gatewayLanguageModelSpecificationSchema,\n  modelType: zod_v4__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\"language\", \"embedding\", \"image\"]).nullish()\n});\nvar gatewayFetchMetadataSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  models: zod_v4__WEBPACK_IMPORTED_MODULE_0__.array(gatewayLanguageModelEntrySchema)\n});\n\n// src/gateway-language-model.ts\n\n\nvar GatewayLanguageModel = class {\n  constructor(modelId, config) {\n    this.modelId = modelId;\n    this.config = config;\n    this.specificationVersion = \"v2\";\n    this.supportedUrls = { \"*/*\": [/.*/] };\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  async getArgs(options) {\n    const { abortSignal: _abortSignal, ...optionsWithoutSignal } = options;\n    return {\n      args: this.maybeEncodeFileParts(optionsWithoutSignal),\n      warnings: []\n    };\n  }\n  async doGenerate(options) {\n    const { args, warnings } = await this.getArgs(options);\n    const { abortSignal } = options;\n    const resolvedHeaders = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.resolve)(this.config.headers());\n    try {\n      const {\n        responseHeaders,\n        value: responseBody,\n        rawValue: rawResponse\n      } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.postJsonToApi)({\n        url: this.getUrl(),\n        headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.combineHeaders)(\n          resolvedHeaders,\n          options.headers,\n          this.getModelConfigHeaders(this.modelId, false),\n          await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.resolve)(this.config.o11yHeaders)\n        ),\n        body: args,\n        successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.createJsonResponseHandler)(zod_v4__WEBPACK_IMPORTED_MODULE_0__.any()),\n        failedResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.createJsonErrorResponseHandler)({\n          errorSchema: zod_v4__WEBPACK_IMPORTED_MODULE_0__.any(),\n          errorToMessage: (data) => data\n        }),\n        ...abortSignal && { abortSignal },\n        fetch: this.config.fetch\n      });\n      return {\n        ...responseBody,\n        request: { body: args },\n        response: { headers: responseHeaders, body: rawResponse },\n        warnings\n      };\n    } catch (error) {\n      throw asGatewayError(error, parseAuthMethod(resolvedHeaders));\n    }\n  }\n  async doStream(options) {\n    const { args, warnings } = await this.getArgs(options);\n    const { abortSignal } = options;\n    const resolvedHeaders = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.resolve)(this.config.headers());\n    try {\n      const { value: response, responseHeaders } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.postJsonToApi)({\n        url: this.getUrl(),\n        headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.combineHeaders)(\n          resolvedHeaders,\n          options.headers,\n          this.getModelConfigHeaders(this.modelId, true),\n          await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.resolve)(this.config.o11yHeaders)\n        ),\n        body: args,\n        successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.createEventSourceResponseHandler)(zod_v4__WEBPACK_IMPORTED_MODULE_0__.any()),\n        failedResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.createJsonErrorResponseHandler)({\n          errorSchema: zod_v4__WEBPACK_IMPORTED_MODULE_0__.any(),\n          errorToMessage: (data) => data\n        }),\n        ...abortSignal && { abortSignal },\n        fetch: this.config.fetch\n      });\n      return {\n        stream: response.pipeThrough(\n          new TransformStream({\n            start(controller) {\n              if (warnings.length > 0) {\n                controller.enqueue({ type: \"stream-start\", warnings });\n              }\n            },\n            transform(chunk, controller) {\n              if (chunk.success) {\n                const streamPart = chunk.value;\n                if (streamPart.type === \"raw\" && !options.includeRawChunks) {\n                  return;\n                }\n                if (streamPart.type === \"response-metadata\" && streamPart.timestamp && typeof streamPart.timestamp === \"string\") {\n                  streamPart.timestamp = new Date(streamPart.timestamp);\n                }\n                controller.enqueue(streamPart);\n              } else {\n                controller.error(\n                  chunk.error\n                );\n              }\n            }\n          })\n        ),\n        request: { body: args },\n        response: { headers: responseHeaders }\n      };\n    } catch (error) {\n      throw asGatewayError(error, parseAuthMethod(resolvedHeaders));\n    }\n  }\n  isFilePart(part) {\n    return part && typeof part === \"object\" && \"type\" in part && part.type === \"file\";\n  }\n  /**\n   * Encodes file parts in the prompt to base64. Mutates the passed options\n   * instance directly to avoid copying the file data.\n   * @param options - The options to encode.\n   * @returns The options with the file parts encoded.\n   */\n  maybeEncodeFileParts(options) {\n    for (const message of options.prompt) {\n      for (const part of message.content) {\n        if (this.isFilePart(part)) {\n          const filePart = part;\n          if (filePart.data instanceof Uint8Array) {\n            const buffer = Uint8Array.from(filePart.data);\n            const base64Data = Buffer.from(buffer).toString(\"base64\");\n            filePart.data = new URL(\n              `data:${filePart.mediaType || \"application/octet-stream\"};base64,${base64Data}`\n            );\n          }\n        }\n      }\n    }\n    return options;\n  }\n  getUrl() {\n    return `${this.config.baseURL}/language-model`;\n  }\n  getModelConfigHeaders(modelId, streaming) {\n    return {\n      \"ai-language-model-specification-version\": \"2\",\n      \"ai-language-model-id\": modelId,\n      \"ai-language-model-streaming\": String(streaming)\n    };\n  }\n};\n\n// src/gateway-embedding-model.ts\n\n\nvar GatewayEmbeddingModel = class {\n  constructor(modelId, config) {\n    this.modelId = modelId;\n    this.config = config;\n    this.specificationVersion = \"v2\";\n    this.maxEmbeddingsPerCall = 2048;\n    this.supportsParallelCalls = true;\n  }\n  get provider() {\n    return this.config.provider;\n  }\n  async doEmbed({\n    values,\n    headers,\n    abortSignal,\n    providerOptions\n  }) {\n    var _a8;\n    const resolvedHeaders = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.resolve)(this.config.headers());\n    try {\n      const {\n        responseHeaders,\n        value: responseBody,\n        rawValue\n      } = await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.postJsonToApi)({\n        url: this.getUrl(),\n        headers: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.combineHeaders)(\n          resolvedHeaders,\n          headers != null ? headers : {},\n          this.getModelConfigHeaders(),\n          await (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.resolve)(this.config.o11yHeaders)\n        ),\n        body: {\n          input: values.length === 1 ? values[0] : values,\n          ...providerOptions != null ? providerOptions : {}\n        },\n        successfulResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.createJsonResponseHandler)(\n          gatewayEmbeddingResponseSchema\n        ),\n        failedResponseHandler: (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.createJsonErrorResponseHandler)({\n          errorSchema: zod_v4__WEBPACK_IMPORTED_MODULE_0__.any(),\n          errorToMessage: (data) => data\n        }),\n        ...abortSignal && { abortSignal },\n        fetch: this.config.fetch\n      });\n      return {\n        embeddings: responseBody.embeddings,\n        usage: (_a8 = responseBody.usage) != null ? _a8 : void 0,\n        providerMetadata: responseBody.providerMetadata,\n        response: { headers: responseHeaders, body: rawValue }\n      };\n    } catch (error) {\n      throw asGatewayError(error, parseAuthMethod(resolvedHeaders));\n    }\n  }\n  getUrl() {\n    return `${this.config.baseURL}/embedding-model`;\n  }\n  getModelConfigHeaders() {\n    return {\n      \"ai-embedding-model-specification-version\": \"2\",\n      \"ai-model-id\": this.modelId\n    };\n  }\n};\nvar gatewayEmbeddingResponseSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  embeddings: zod_v4__WEBPACK_IMPORTED_MODULE_0__.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.number())),\n  usage: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({ tokens: zod_v4__WEBPACK_IMPORTED_MODULE_0__.number() }).nullish(),\n  providerMetadata: zod_v4__WEBPACK_IMPORTED_MODULE_0__.record(zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(), zod_v4__WEBPACK_IMPORTED_MODULE_0__.record(zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(), zod_v4__WEBPACK_IMPORTED_MODULE_0__.unknown())).optional()\n});\n\n// src/vercel-environment.ts\nasync function getVercelOidcToken() {\n  var _a8, _b8;\n  const token = (_b8 = (_a8 = getContext().headers) == null ? void 0 : _a8[\"x-vercel-oidc-token\"]) != null ? _b8 : process.env.VERCEL_OIDC_TOKEN;\n  if (!token) {\n    throw new GatewayAuthenticationError({\n      message: \"OIDC token not available\",\n      statusCode: 401\n    });\n  }\n  return token;\n}\nasync function getVercelRequestId() {\n  var _a8;\n  return (_a8 = getContext().headers) == null ? void 0 : _a8[\"x-vercel-id\"];\n}\nvar SYMBOL_FOR_REQ_CONTEXT = Symbol.for(\"@vercel/request-context\");\nfunction getContext() {\n  var _a8, _b8, _c;\n  const fromSymbol = globalThis;\n  return (_c = (_b8 = (_a8 = fromSymbol[SYMBOL_FOR_REQ_CONTEXT]) == null ? void 0 : _a8.get) == null ? void 0 : _b8.call(_a8)) != null ? _c : {};\n}\n\n// src/gateway-provider.ts\nvar AI_GATEWAY_PROTOCOL_VERSION = \"0.0.1\";\nfunction createGatewayProvider(options = {}) {\n  var _a8, _b8;\n  let pendingMetadata = null;\n  let metadataCache = null;\n  const cacheRefreshMillis = (_a8 = options.metadataCacheRefreshMillis) != null ? _a8 : 1e3 * 60 * 5;\n  let lastFetchTime = 0;\n  const baseURL = (_b8 = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.withoutTrailingSlash)(options.baseURL)) != null ? _b8 : \"https://ai-gateway.vercel.sh/v1/ai\";\n  const getHeaders = async () => {\n    const auth = await getGatewayAuthToken(options);\n    if (auth) {\n      return {\n        Authorization: `Bearer ${auth.token}`,\n        \"ai-gateway-protocol-version\": AI_GATEWAY_PROTOCOL_VERSION,\n        [GATEWAY_AUTH_METHOD_HEADER]: auth.authMethod,\n        ...options.headers\n      };\n    }\n    throw GatewayAuthenticationError.createContextualError({\n      apiKeyProvided: false,\n      oidcTokenProvided: false,\n      statusCode: 401\n    });\n  };\n  const createO11yHeaders = () => {\n    const deploymentId = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.loadOptionalSetting)({\n      settingValue: void 0,\n      environmentVariableName: \"VERCEL_DEPLOYMENT_ID\"\n    });\n    const environment = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.loadOptionalSetting)({\n      settingValue: void 0,\n      environmentVariableName: \"VERCEL_ENV\"\n    });\n    const region = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.loadOptionalSetting)({\n      settingValue: void 0,\n      environmentVariableName: \"VERCEL_REGION\"\n    });\n    return async () => {\n      const requestId = await getVercelRequestId();\n      return {\n        ...deploymentId && { \"ai-o11y-deployment-id\": deploymentId },\n        ...environment && { \"ai-o11y-environment\": environment },\n        ...region && { \"ai-o11y-region\": region },\n        ...requestId && { \"ai-o11y-request-id\": requestId }\n      };\n    };\n  };\n  const createLanguageModel = (modelId) => {\n    return new GatewayLanguageModel(modelId, {\n      provider: \"gateway\",\n      baseURL,\n      headers: getHeaders,\n      fetch: options.fetch,\n      o11yHeaders: createO11yHeaders()\n    });\n  };\n  const getAvailableModels = async () => {\n    var _a9, _b9, _c;\n    const now = (_c = (_b9 = (_a9 = options._internal) == null ? void 0 : _a9.currentDate) == null ? void 0 : _b9.call(_a9).getTime()) != null ? _c : Date.now();\n    if (!pendingMetadata || now - lastFetchTime > cacheRefreshMillis) {\n      lastFetchTime = now;\n      pendingMetadata = new GatewayFetchMetadata({\n        baseURL,\n        headers: getHeaders,\n        fetch: options.fetch\n      }).getAvailableModels().then((metadata) => {\n        metadataCache = metadata;\n        return metadata;\n      }).catch(async (error) => {\n        throw asGatewayError(error, parseAuthMethod(await getHeaders()));\n      });\n    }\n    return metadataCache ? Promise.resolve(metadataCache) : pendingMetadata;\n  };\n  const provider = function(modelId) {\n    if (new.target) {\n      throw new Error(\n        \"The Gateway Provider model function cannot be called with the new keyword.\"\n      );\n    }\n    return createLanguageModel(modelId);\n  };\n  provider.getAvailableModels = getAvailableModels;\n  provider.imageModel = (modelId) => {\n    throw new _ai_sdk_provider__WEBPACK_IMPORTED_MODULE_1__.NoSuchModelError({ modelId, modelType: \"imageModel\" });\n  };\n  provider.languageModel = createLanguageModel;\n  provider.textEmbeddingModel = (modelId) => {\n    return new GatewayEmbeddingModel(modelId, {\n      provider: \"gateway\",\n      baseURL,\n      headers: getHeaders,\n      fetch: options.fetch,\n      o11yHeaders: createO11yHeaders()\n    });\n  };\n  return provider;\n}\nvar gateway = createGatewayProvider();\nasync function getGatewayAuthToken(options) {\n  const apiKey = (0,_ai_sdk_provider_utils__WEBPACK_IMPORTED_MODULE_2__.loadOptionalSetting)({\n    settingValue: options.apiKey,\n    environmentVariableName: \"AI_GATEWAY_API_KEY\"\n  });\n  if (apiKey) {\n    return {\n      token: apiKey,\n      authMethod: \"api-key\"\n    };\n  }\n  try {\n    const oidcToken = await getVercelOidcToken();\n    return {\n      token: oidcToken,\n      authMethod: \"oidc\"\n    };\n  } catch (e) {\n    return null;\n  }\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQGFpLXNkaytnYXRld2F5QDEuMC4xNV96b2RANC4xLjUvbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDb0Q7QUFJcEI7O0FBRWhDO0FBQ2dEOztBQUVoRDtBQUNpQzs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx5Q0FBeUMsS0FBSztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksSUFBSTtBQUNSLFlBQVksNEJBQTRCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0EsTUFBTTtBQUNOOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxNQUFNO0FBQ047O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0EseUNBQXlDLE1BQU07QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLElBQUk7QUFDUixZQUFZLDRCQUE0QjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHlDQUF5QyxNQUFN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QkFBMEI7QUFDakQsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhEQUFnQixHQUFHLGtDQUFrQztBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwyRUFBbUI7QUFDcEM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBWUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYi1wcm90b3R5cGUvLi9ub2RlX21vZHVsZXMvLnBucG0vQGFpLXNkaytnYXRld2F5QDEuMC4xNV96b2RANC4xLjUvbm9kZV9tb2R1bGVzL0BhaS1zZGsvZ2F0ZXdheS9kaXN0L2luZGV4Lm1qcz8yNzc4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9nYXRld2F5LXByb3ZpZGVyLnRzXG5pbXBvcnQgeyBOb1N1Y2hNb2RlbEVycm9yIH0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXJcIjtcbmltcG9ydCB7XG4gIGxvYWRPcHRpb25hbFNldHRpbmcsXG4gIHdpdGhvdXRUcmFpbGluZ1NsYXNoXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5cbi8vIHNyYy9lcnJvcnMvYXMtZ2F0ZXdheS1lcnJvci50c1xuaW1wb3J0IHsgQVBJQ2FsbEVycm9yIH0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXJcIjtcblxuLy8gc3JjL2Vycm9ycy9jcmVhdGUtZ2F0ZXdheS1lcnJvci50c1xuaW1wb3J0IHsgeiBhcyB6MiB9IGZyb20gXCJ6b2QvdjRcIjtcblxuLy8gc3JjL2Vycm9ycy9nYXRld2F5LWVycm9yLnRzXG52YXIgbWFya2VyID0gXCJ2ZXJjZWwuYWkuZ2F0ZXdheS5lcnJvclwiO1xudmFyIHN5bWJvbCA9IFN5bWJvbC5mb3IobWFya2VyKTtcbnZhciBfYSwgX2I7XG52YXIgR2F0ZXdheUVycm9yID0gY2xhc3MgX0dhdGV3YXlFcnJvciBleHRlbmRzIChfYiA9IEVycm9yLCBfYSA9IHN5bWJvbCwgX2IpIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lc3NhZ2UsXG4gICAgc3RhdHVzQ29kZSA9IDUwMCxcbiAgICBjYXVzZVxuICB9KSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpc1tfYV0gPSB0cnVlO1xuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgdGhpcy5jYXVzZSA9IGNhdXNlO1xuICB9XG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIGdpdmVuIGVycm9yIGlzIGEgR2F0ZXdheSBFcnJvci5cbiAgICogQHBhcmFtIHt1bmtub3dufSBlcnJvciAtIFRoZSBlcnJvciB0byBjaGVjay5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIGVycm9yIGlzIGEgR2F0ZXdheSBFcnJvciwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgKi9cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3IpIHtcbiAgICByZXR1cm4gX0dhdGV3YXlFcnJvci5oYXNNYXJrZXIoZXJyb3IpO1xuICB9XG4gIHN0YXRpYyBoYXNNYXJrZXIoZXJyb3IpIHtcbiAgICByZXR1cm4gdHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIGVycm9yICE9PSBudWxsICYmIHN5bWJvbCBpbiBlcnJvciAmJiBlcnJvcltzeW1ib2xdID09PSB0cnVlO1xuICB9XG59O1xuXG4vLyBzcmMvZXJyb3JzL2dhdGV3YXktYXV0aGVudGljYXRpb24tZXJyb3IudHNcbnZhciBuYW1lID0gXCJHYXRld2F5QXV0aGVudGljYXRpb25FcnJvclwiO1xudmFyIG1hcmtlcjIgPSBgdmVyY2VsLmFpLmdhdGV3YXkuZXJyb3IuJHtuYW1lfWA7XG52YXIgc3ltYm9sMiA9IFN5bWJvbC5mb3IobWFya2VyMik7XG52YXIgX2EyLCBfYjI7XG52YXIgR2F0ZXdheUF1dGhlbnRpY2F0aW9uRXJyb3IgPSBjbGFzcyBfR2F0ZXdheUF1dGhlbnRpY2F0aW9uRXJyb3IgZXh0ZW5kcyAoX2IyID0gR2F0ZXdheUVycm9yLCBfYTIgPSBzeW1ib2wyLCBfYjIpIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIG1lc3NhZ2UgPSBcIkF1dGhlbnRpY2F0aW9uIGZhaWxlZFwiLFxuICAgIHN0YXR1c0NvZGUgPSA0MDEsXG4gICAgY2F1c2VcbiAgfSA9IHt9KSB7XG4gICAgc3VwZXIoeyBtZXNzYWdlLCBzdGF0dXNDb2RlLCBjYXVzZSB9KTtcbiAgICB0aGlzW19hMl0gPSB0cnVlO1xuICAgIC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy50eXBlID0gXCJhdXRoZW50aWNhdGlvbl9lcnJvclwiO1xuICB9XG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yKSB7XG4gICAgcmV0dXJuIEdhdGV3YXlFcnJvci5oYXNNYXJrZXIoZXJyb3IpICYmIHN5bWJvbDIgaW4gZXJyb3I7XG4gIH1cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBjb250ZXh0dWFsIGVycm9yIG1lc3NhZ2Ugd2hlbiBhdXRoZW50aWNhdGlvbiBmYWlsc1xuICAgKi9cbiAgc3RhdGljIGNyZWF0ZUNvbnRleHR1YWxFcnJvcih7XG4gICAgYXBpS2V5UHJvdmlkZWQsXG4gICAgb2lkY1Rva2VuUHJvdmlkZWQsXG4gICAgbWVzc2FnZSA9IFwiQXV0aGVudGljYXRpb24gZmFpbGVkXCIsXG4gICAgc3RhdHVzQ29kZSA9IDQwMSxcbiAgICBjYXVzZVxuICB9KSB7XG4gICAgbGV0IGNvbnRleHR1YWxNZXNzYWdlO1xuICAgIGlmIChhcGlLZXlQcm92aWRlZCkge1xuICAgICAgY29udGV4dHVhbE1lc3NhZ2UgPSBgQUkgR2F0ZXdheSBhdXRoZW50aWNhdGlvbiBmYWlsZWQ6IEludmFsaWQgQVBJIGtleSBwcm92aWRlZC5cblxuVGhlIHRva2VuIGlzIGV4cGVjdGVkIHRvIGJlIHByb3ZpZGVkIHZpYSB0aGUgJ2FwaUtleScgb3B0aW9uIG9yICdBSV9HQVRFV0FZX0FQSV9LRVknIGVudmlyb25tZW50IHZhcmlhYmxlLmA7XG4gICAgfSBlbHNlIGlmIChvaWRjVG9rZW5Qcm92aWRlZCkge1xuICAgICAgY29udGV4dHVhbE1lc3NhZ2UgPSBgQUkgR2F0ZXdheSBhdXRoZW50aWNhdGlvbiBmYWlsZWQ6IEludmFsaWQgT0lEQyB0b2tlbiBwcm92aWRlZC5cblxuVGhlIHRva2VuIGlzIGV4cGVjdGVkIHRvIGJlIHByb3ZpZGVkIHZpYSB0aGUgJ1ZFUkNFTF9PSURDX1RPS0VOJyBlbnZpcm9ubWVudCB2YXJpYWJsZS4gSXQgZXhwaXJlcyBldmVyeSAxMiBob3Vycy5cbi0gbWFrZSBzdXJlIHlvdXIgVmVyY2VsIHByb2plY3Qgc2V0dGluZ3MgaGF2ZSBPSURDIGVuYWJsZWRcbi0gaWYgcnVubmluZyBsb2NhbGx5IHdpdGggJ3ZlcmNlbCBkZXYnLCB0aGUgdG9rZW4gaXMgYXV0b21hdGljYWxseSBvYnRhaW5lZCBhbmQgcmVmcmVzaGVkXG4tIGlmIHJ1bm5pbmcgbG9jYWxseSB3aXRoIHlvdXIgb3duIGRldiBzZXJ2ZXIsIHJ1biAndmVyY2VsIGVudiBwdWxsJyB0byBmZXRjaCB0aGUgdG9rZW5cbi0gaW4gcHJvZHVjdGlvbi9wcmV2aWV3LCB0aGUgdG9rZW4gaXMgYXV0b21hdGljYWxseSBvYnRhaW5lZCBhbmQgcmVmcmVzaGVkXG5cbkFsdGVybmF0aXZlOiBQcm92aWRlIGFuIEFQSSBrZXkgdmlhICdhcGlLZXknIG9wdGlvbiBvciAnQUlfR0FURVdBWV9BUElfS0VZJyBlbnZpcm9ubWVudCB2YXJpYWJsZS5gO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZXh0dWFsTWVzc2FnZSA9IGBBSSBHYXRld2F5IGF1dGhlbnRpY2F0aW9uIGZhaWxlZDogTm8gYXV0aGVudGljYXRpb24gcHJvdmlkZWQuXG5cblByb3ZpZGUgZWl0aGVyIGFuIEFQSSBrZXkgb3IgT0lEQyB0b2tlbi5cblxuQVBJIGtleSBpbnN0cnVjdGlvbnM6XG5cblRoZSB0b2tlbiBpcyBleHBlY3RlZCB0byBiZSBwcm92aWRlZCB2aWEgdGhlICdhcGlLZXknIG9wdGlvbiBvciAnQUlfR0FURVdBWV9BUElfS0VZJyBlbnZpcm9ubWVudCB2YXJpYWJsZS5cblxuT0lEQyB0b2tlbiBpbnN0cnVjdGlvbnM6XG5cblRoZSB0b2tlbiBpcyBleHBlY3RlZCB0byBiZSBwcm92aWRlZCB2aWEgdGhlICdWRVJDRUxfT0lEQ19UT0tFTicgZW52aXJvbm1lbnQgdmFyaWFibGUuIEl0IGV4cGlyZXMgZXZlcnkgMTIgaG91cnMuXG4tIG1ha2Ugc3VyZSB5b3VyIFZlcmNlbCBwcm9qZWN0IHNldHRpbmdzIGhhdmUgT0lEQyBlbmFibGVkXG4tIGlmIHJ1bm5pbmcgbG9jYWxseSB3aXRoICd2ZXJjZWwgZGV2JywgdGhlIHRva2VuIGlzIGF1dG9tYXRpY2FsbHkgb2J0YWluZWQgYW5kIHJlZnJlc2hlZFxuLSBpZiBydW5uaW5nIGxvY2FsbHkgd2l0aCB5b3VyIG93biBkZXYgc2VydmVyLCBydW4gJ3ZlcmNlbCBlbnYgcHVsbCcgdG8gZmV0Y2ggdGhlIHRva2VuXG4tIGluIHByb2R1Y3Rpb24vcHJldmlldywgdGhlIHRva2VuIGlzIGF1dG9tYXRpY2FsbHkgb2J0YWluZWQgYW5kIHJlZnJlc2hlZGA7XG4gICAgfVxuICAgIHJldHVybiBuZXcgX0dhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IGNvbnRleHR1YWxNZXNzYWdlLFxuICAgICAgc3RhdHVzQ29kZSxcbiAgICAgIGNhdXNlXG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIHNyYy9lcnJvcnMvZ2F0ZXdheS1pbnZhbGlkLXJlcXVlc3QtZXJyb3IudHNcbnZhciBuYW1lMiA9IFwiR2F0ZXdheUludmFsaWRSZXF1ZXN0RXJyb3JcIjtcbnZhciBtYXJrZXIzID0gYHZlcmNlbC5haS5nYXRld2F5LmVycm9yLiR7bmFtZTJ9YDtcbnZhciBzeW1ib2wzID0gU3ltYm9sLmZvcihtYXJrZXIzKTtcbnZhciBfYTMsIF9iMztcbnZhciBHYXRld2F5SW52YWxpZFJlcXVlc3RFcnJvciA9IGNsYXNzIGV4dGVuZHMgKF9iMyA9IEdhdGV3YXlFcnJvciwgX2EzID0gc3ltYm9sMywgX2IzKSB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZXNzYWdlID0gXCJJbnZhbGlkIHJlcXVlc3RcIixcbiAgICBzdGF0dXNDb2RlID0gNDAwLFxuICAgIGNhdXNlXG4gIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgbWVzc2FnZSwgc3RhdHVzQ29kZSwgY2F1c2UgfSk7XG4gICAgdGhpc1tfYTNdID0gdHJ1ZTtcbiAgICAvLyB1c2VkIGluIGlzSW5zdGFuY2VcbiAgICB0aGlzLm5hbWUgPSBuYW1lMjtcbiAgICB0aGlzLnR5cGUgPSBcImludmFsaWRfcmVxdWVzdF9lcnJvclwiO1xuICB9XG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yKSB7XG4gICAgcmV0dXJuIEdhdGV3YXlFcnJvci5oYXNNYXJrZXIoZXJyb3IpICYmIHN5bWJvbDMgaW4gZXJyb3I7XG4gIH1cbn07XG5cbi8vIHNyYy9lcnJvcnMvZ2F0ZXdheS1yYXRlLWxpbWl0LWVycm9yLnRzXG52YXIgbmFtZTMgPSBcIkdhdGV3YXlSYXRlTGltaXRFcnJvclwiO1xudmFyIG1hcmtlcjQgPSBgdmVyY2VsLmFpLmdhdGV3YXkuZXJyb3IuJHtuYW1lM31gO1xudmFyIHN5bWJvbDQgPSBTeW1ib2wuZm9yKG1hcmtlcjQpO1xudmFyIF9hNCwgX2I0O1xudmFyIEdhdGV3YXlSYXRlTGltaXRFcnJvciA9IGNsYXNzIGV4dGVuZHMgKF9iNCA9IEdhdGV3YXlFcnJvciwgX2E0ID0gc3ltYm9sNCwgX2I0KSB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZXNzYWdlID0gXCJSYXRlIGxpbWl0IGV4Y2VlZGVkXCIsXG4gICAgc3RhdHVzQ29kZSA9IDQyOSxcbiAgICBjYXVzZVxuICB9ID0ge30pIHtcbiAgICBzdXBlcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICAgIHRoaXNbX2E0XSA9IHRydWU7XG4gICAgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG4gICAgdGhpcy5uYW1lID0gbmFtZTM7XG4gICAgdGhpcy50eXBlID0gXCJyYXRlX2xpbWl0X2V4Y2VlZGVkXCI7XG4gIH1cbiAgc3RhdGljIGlzSW5zdGFuY2UoZXJyb3IpIHtcbiAgICByZXR1cm4gR2F0ZXdheUVycm9yLmhhc01hcmtlcihlcnJvcikgJiYgc3ltYm9sNCBpbiBlcnJvcjtcbiAgfVxufTtcblxuLy8gc3JjL2Vycm9ycy9nYXRld2F5LW1vZGVsLW5vdC1mb3VuZC1lcnJvci50c1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2QvdjRcIjtcbnZhciBuYW1lNCA9IFwiR2F0ZXdheU1vZGVsTm90Rm91bmRFcnJvclwiO1xudmFyIG1hcmtlcjUgPSBgdmVyY2VsLmFpLmdhdGV3YXkuZXJyb3IuJHtuYW1lNH1gO1xudmFyIHN5bWJvbDUgPSBTeW1ib2wuZm9yKG1hcmtlcjUpO1xudmFyIG1vZGVsTm90Rm91bmRQYXJhbVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgbW9kZWxJZDogei5zdHJpbmcoKVxufSk7XG52YXIgX2E1LCBfYjU7XG52YXIgR2F0ZXdheU1vZGVsTm90Rm91bmRFcnJvciA9IGNsYXNzIGV4dGVuZHMgKF9iNSA9IEdhdGV3YXlFcnJvciwgX2E1ID0gc3ltYm9sNSwgX2I1KSB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZXNzYWdlID0gXCJNb2RlbCBub3QgZm91bmRcIixcbiAgICBzdGF0dXNDb2RlID0gNDA0LFxuICAgIG1vZGVsSWQsXG4gICAgY2F1c2VcbiAgfSA9IHt9KSB7XG4gICAgc3VwZXIoeyBtZXNzYWdlLCBzdGF0dXNDb2RlLCBjYXVzZSB9KTtcbiAgICB0aGlzW19hNV0gPSB0cnVlO1xuICAgIC8vIHVzZWQgaW4gaXNJbnN0YW5jZVxuICAgIHRoaXMubmFtZSA9IG5hbWU0O1xuICAgIHRoaXMudHlwZSA9IFwibW9kZWxfbm90X2ZvdW5kXCI7XG4gICAgdGhpcy5tb2RlbElkID0gbW9kZWxJZDtcbiAgfVxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcikge1xuICAgIHJldHVybiBHYXRld2F5RXJyb3IuaGFzTWFya2VyKGVycm9yKSAmJiBzeW1ib2w1IGluIGVycm9yO1xuICB9XG59O1xuXG4vLyBzcmMvZXJyb3JzL2dhdGV3YXktaW50ZXJuYWwtc2VydmVyLWVycm9yLnRzXG52YXIgbmFtZTUgPSBcIkdhdGV3YXlJbnRlcm5hbFNlcnZlckVycm9yXCI7XG52YXIgbWFya2VyNiA9IGB2ZXJjZWwuYWkuZ2F0ZXdheS5lcnJvci4ke25hbWU1fWA7XG52YXIgc3ltYm9sNiA9IFN5bWJvbC5mb3IobWFya2VyNik7XG52YXIgX2E2LCBfYjY7XG52YXIgR2F0ZXdheUludGVybmFsU2VydmVyRXJyb3IgPSBjbGFzcyBleHRlbmRzIChfYjYgPSBHYXRld2F5RXJyb3IsIF9hNiA9IHN5bWJvbDYsIF9iNikge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgbWVzc2FnZSA9IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsXG4gICAgc3RhdHVzQ29kZSA9IDUwMCxcbiAgICBjYXVzZVxuICB9ID0ge30pIHtcbiAgICBzdXBlcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICAgIHRoaXNbX2E2XSA9IHRydWU7XG4gICAgLy8gdXNlZCBpbiBpc0luc3RhbmNlXG4gICAgdGhpcy5uYW1lID0gbmFtZTU7XG4gICAgdGhpcy50eXBlID0gXCJpbnRlcm5hbF9zZXJ2ZXJfZXJyb3JcIjtcbiAgfVxuICBzdGF0aWMgaXNJbnN0YW5jZShlcnJvcikge1xuICAgIHJldHVybiBHYXRld2F5RXJyb3IuaGFzTWFya2VyKGVycm9yKSAmJiBzeW1ib2w2IGluIGVycm9yO1xuICB9XG59O1xuXG4vLyBzcmMvZXJyb3JzL2dhdGV3YXktcmVzcG9uc2UtZXJyb3IudHNcbnZhciBuYW1lNiA9IFwiR2F0ZXdheVJlc3BvbnNlRXJyb3JcIjtcbnZhciBtYXJrZXI3ID0gYHZlcmNlbC5haS5nYXRld2F5LmVycm9yLiR7bmFtZTZ9YDtcbnZhciBzeW1ib2w3ID0gU3ltYm9sLmZvcihtYXJrZXI3KTtcbnZhciBfYTcsIF9iNztcbnZhciBHYXRld2F5UmVzcG9uc2VFcnJvciA9IGNsYXNzIGV4dGVuZHMgKF9iNyA9IEdhdGV3YXlFcnJvciwgX2E3ID0gc3ltYm9sNywgX2I3KSB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBtZXNzYWdlID0gXCJJbnZhbGlkIHJlc3BvbnNlIGZyb20gR2F0ZXdheVwiLFxuICAgIHN0YXR1c0NvZGUgPSA1MDIsXG4gICAgcmVzcG9uc2UsXG4gICAgdmFsaWRhdGlvbkVycm9yLFxuICAgIGNhdXNlXG4gIH0gPSB7fSkge1xuICAgIHN1cGVyKHsgbWVzc2FnZSwgc3RhdHVzQ29kZSwgY2F1c2UgfSk7XG4gICAgdGhpc1tfYTddID0gdHJ1ZTtcbiAgICAvLyB1c2VkIGluIGlzSW5zdGFuY2VcbiAgICB0aGlzLm5hbWUgPSBuYW1lNjtcbiAgICB0aGlzLnR5cGUgPSBcInJlc3BvbnNlX2Vycm9yXCI7XG4gICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIHRoaXMudmFsaWRhdGlvbkVycm9yID0gdmFsaWRhdGlvbkVycm9yO1xuICB9XG4gIHN0YXRpYyBpc0luc3RhbmNlKGVycm9yKSB7XG4gICAgcmV0dXJuIEdhdGV3YXlFcnJvci5oYXNNYXJrZXIoZXJyb3IpICYmIHN5bWJvbDcgaW4gZXJyb3I7XG4gIH1cbn07XG5cbi8vIHNyYy9lcnJvcnMvY3JlYXRlLWdhdGV3YXktZXJyb3IudHNcbmZ1bmN0aW9uIGNyZWF0ZUdhdGV3YXlFcnJvckZyb21SZXNwb25zZSh7XG4gIHJlc3BvbnNlLFxuICBzdGF0dXNDb2RlLFxuICBkZWZhdWx0TWVzc2FnZSA9IFwiR2F0ZXdheSByZXF1ZXN0IGZhaWxlZFwiLFxuICBjYXVzZSxcbiAgYXV0aE1ldGhvZFxufSkge1xuICBjb25zdCBwYXJzZVJlc3VsdCA9IGdhdGV3YXlFcnJvclJlc3BvbnNlU2NoZW1hLnNhZmVQYXJzZShyZXNwb25zZSk7XG4gIGlmICghcGFyc2VSZXN1bHQuc3VjY2Vzcykge1xuICAgIHJldHVybiBuZXcgR2F0ZXdheVJlc3BvbnNlRXJyb3Ioe1xuICAgICAgbWVzc2FnZTogYEludmFsaWQgZXJyb3IgcmVzcG9uc2UgZm9ybWF0OiAke2RlZmF1bHRNZXNzYWdlfWAsXG4gICAgICBzdGF0dXNDb2RlLFxuICAgICAgcmVzcG9uc2UsXG4gICAgICB2YWxpZGF0aW9uRXJyb3I6IHBhcnNlUmVzdWx0LmVycm9yLFxuICAgICAgY2F1c2VcbiAgICB9KTtcbiAgfVxuICBjb25zdCB2YWxpZGF0ZWRSZXNwb25zZSA9IHBhcnNlUmVzdWx0LmRhdGE7XG4gIGNvbnN0IGVycm9yVHlwZSA9IHZhbGlkYXRlZFJlc3BvbnNlLmVycm9yLnR5cGU7XG4gIGNvbnN0IG1lc3NhZ2UgPSB2YWxpZGF0ZWRSZXNwb25zZS5lcnJvci5tZXNzYWdlO1xuICBzd2l0Y2ggKGVycm9yVHlwZSkge1xuICAgIGNhc2UgXCJhdXRoZW50aWNhdGlvbl9lcnJvclwiOlxuICAgICAgcmV0dXJuIEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yLmNyZWF0ZUNvbnRleHR1YWxFcnJvcih7XG4gICAgICAgIGFwaUtleVByb3ZpZGVkOiBhdXRoTWV0aG9kID09PSBcImFwaS1rZXlcIixcbiAgICAgICAgb2lkY1Rva2VuUHJvdmlkZWQ6IGF1dGhNZXRob2QgPT09IFwib2lkY1wiLFxuICAgICAgICBzdGF0dXNDb2RlLFxuICAgICAgICBjYXVzZVxuICAgICAgfSk7XG4gICAgY2FzZSBcImludmFsaWRfcmVxdWVzdF9lcnJvclwiOlxuICAgICAgcmV0dXJuIG5ldyBHYXRld2F5SW52YWxpZFJlcXVlc3RFcnJvcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICAgIGNhc2UgXCJyYXRlX2xpbWl0X2V4Y2VlZGVkXCI6XG4gICAgICByZXR1cm4gbmV3IEdhdGV3YXlSYXRlTGltaXRFcnJvcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICAgIGNhc2UgXCJtb2RlbF9ub3RfZm91bmRcIjoge1xuICAgICAgY29uc3QgbW9kZWxSZXN1bHQgPSBtb2RlbE5vdEZvdW5kUGFyYW1TY2hlbWEuc2FmZVBhcnNlKFxuICAgICAgICB2YWxpZGF0ZWRSZXNwb25zZS5lcnJvci5wYXJhbVxuICAgICAgKTtcbiAgICAgIHJldHVybiBuZXcgR2F0ZXdheU1vZGVsTm90Rm91bmRFcnJvcih7XG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIHN0YXR1c0NvZGUsXG4gICAgICAgIG1vZGVsSWQ6IG1vZGVsUmVzdWx0LnN1Y2Nlc3MgPyBtb2RlbFJlc3VsdC5kYXRhLm1vZGVsSWQgOiB2b2lkIDAsXG4gICAgICAgIGNhdXNlXG4gICAgICB9KTtcbiAgICB9XG4gICAgY2FzZSBcImludGVybmFsX3NlcnZlcl9lcnJvclwiOlxuICAgICAgcmV0dXJuIG5ldyBHYXRld2F5SW50ZXJuYWxTZXJ2ZXJFcnJvcih7IG1lc3NhZ2UsIHN0YXR1c0NvZGUsIGNhdXNlIH0pO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gbmV3IEdhdGV3YXlJbnRlcm5hbFNlcnZlckVycm9yKHsgbWVzc2FnZSwgc3RhdHVzQ29kZSwgY2F1c2UgfSk7XG4gIH1cbn1cbnZhciBnYXRld2F5RXJyb3JSZXNwb25zZVNjaGVtYSA9IHoyLm9iamVjdCh7XG4gIGVycm9yOiB6Mi5vYmplY3Qoe1xuICAgIG1lc3NhZ2U6IHoyLnN0cmluZygpLFxuICAgIHR5cGU6IHoyLnN0cmluZygpLm51bGxpc2goKSxcbiAgICBwYXJhbTogejIudW5rbm93bigpLm51bGxpc2goKSxcbiAgICBjb2RlOiB6Mi51bmlvbihbejIuc3RyaW5nKCksIHoyLm51bWJlcigpXSkubnVsbGlzaCgpXG4gIH0pXG59KTtcblxuLy8gc3JjL2Vycm9ycy9hcy1nYXRld2F5LWVycm9yLnRzXG5mdW5jdGlvbiBhc0dhdGV3YXlFcnJvcihlcnJvciwgYXV0aE1ldGhvZCkge1xuICB2YXIgX2E4O1xuICBpZiAoR2F0ZXdheUVycm9yLmlzSW5zdGFuY2UoZXJyb3IpKSB7XG4gICAgcmV0dXJuIGVycm9yO1xuICB9XG4gIGlmIChBUElDYWxsRXJyb3IuaXNJbnN0YW5jZShlcnJvcikpIHtcbiAgICByZXR1cm4gY3JlYXRlR2F0ZXdheUVycm9yRnJvbVJlc3BvbnNlKHtcbiAgICAgIHJlc3BvbnNlOiBleHRyYWN0QXBpQ2FsbFJlc3BvbnNlKGVycm9yKSxcbiAgICAgIHN0YXR1c0NvZGU6IChfYTggPSBlcnJvci5zdGF0dXNDb2RlKSAhPSBudWxsID8gX2E4IDogNTAwLFxuICAgICAgZGVmYXVsdE1lc3NhZ2U6IFwiR2F0ZXdheSByZXF1ZXN0IGZhaWxlZFwiLFxuICAgICAgY2F1c2U6IGVycm9yLFxuICAgICAgYXV0aE1ldGhvZFxuICAgIH0pO1xuICB9XG4gIHJldHVybiBjcmVhdGVHYXRld2F5RXJyb3JGcm9tUmVzcG9uc2Uoe1xuICAgIHJlc3BvbnNlOiB7fSxcbiAgICBzdGF0dXNDb2RlOiA1MDAsXG4gICAgZGVmYXVsdE1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBgR2F0ZXdheSByZXF1ZXN0IGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWAgOiBcIlVua25vd24gR2F0ZXdheSBlcnJvclwiLFxuICAgIGNhdXNlOiBlcnJvcixcbiAgICBhdXRoTWV0aG9kXG4gIH0pO1xufVxuXG4vLyBzcmMvZXJyb3JzL2V4dHJhY3QtYXBpLWNhbGwtcmVzcG9uc2UudHNcbmZ1bmN0aW9uIGV4dHJhY3RBcGlDYWxsUmVzcG9uc2UoZXJyb3IpIHtcbiAgaWYgKGVycm9yLmRhdGEgIT09IHZvaWQgMCkge1xuICAgIHJldHVybiBlcnJvci5kYXRhO1xuICB9XG4gIGlmIChlcnJvci5yZXNwb25zZUJvZHkgIT0gbnVsbCkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShlcnJvci5yZXNwb25zZUJvZHkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBlcnJvci5yZXNwb25zZUJvZHk7XG4gICAgfVxuICB9XG4gIHJldHVybiB7fTtcbn1cblxuLy8gc3JjL2Vycm9ycy9wYXJzZS1hdXRoLW1ldGhvZC50c1xuaW1wb3J0IHsgeiBhcyB6MyB9IGZyb20gXCJ6b2QvdjRcIjtcbnZhciBHQVRFV0FZX0FVVEhfTUVUSE9EX0hFQURFUiA9IFwiYWktZ2F0ZXdheS1hdXRoLW1ldGhvZFwiO1xuZnVuY3Rpb24gcGFyc2VBdXRoTWV0aG9kKGhlYWRlcnMpIHtcbiAgY29uc3QgcmVzdWx0ID0gZ2F0ZXdheUF1dGhNZXRob2RTY2hlbWEuc2FmZVBhcnNlKFxuICAgIGhlYWRlcnNbR0FURVdBWV9BVVRIX01FVEhPRF9IRUFERVJdXG4gICk7XG4gIHJldHVybiByZXN1bHQuc3VjY2VzcyA/IHJlc3VsdC5kYXRhIDogdm9pZCAwO1xufVxudmFyIGdhdGV3YXlBdXRoTWV0aG9kU2NoZW1hID0gejMudW5pb24oW1xuICB6My5saXRlcmFsKFwiYXBpLWtleVwiKSxcbiAgejMubGl0ZXJhbChcIm9pZGNcIilcbl0pO1xuXG4vLyBzcmMvZ2F0ZXdheS1mZXRjaC1tZXRhZGF0YS50c1xuaW1wb3J0IHtcbiAgY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyLFxuICBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyLFxuICBnZXRGcm9tQXBpLFxuICByZXNvbHZlXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IGFzIHo0IH0gZnJvbSBcInpvZC92NFwiO1xudmFyIEdhdGV3YXlGZXRjaE1ldGFkYXRhID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgfVxuICBhc3luYyBnZXRBdmFpbGFibGVNb2RlbHMoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IGF3YWl0IGdldEZyb21BcGkoe1xuICAgICAgICB1cmw6IGAke3RoaXMuY29uZmlnLmJhc2VVUkx9L2NvbmZpZ2AsXG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IHJlc29sdmUodGhpcy5jb25maWcuaGVhZGVycygpKSxcbiAgICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcihcbiAgICAgICAgICBnYXRld2F5RmV0Y2hNZXRhZGF0YVNjaGVtYVxuICAgICAgICApLFxuICAgICAgICBmYWlsZWRSZXNwb25zZUhhbmRsZXI6IGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlcih7XG4gICAgICAgICAgZXJyb3JTY2hlbWE6IHo0LmFueSgpLFxuICAgICAgICAgIGVycm9yVG9NZXNzYWdlOiAoZGF0YSkgPT4gZGF0YVxuICAgICAgICB9KSxcbiAgICAgICAgZmV0Y2g6IHRoaXMuY29uZmlnLmZldGNoXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgYXNHYXRld2F5RXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxufTtcbnZhciBnYXRld2F5TGFuZ3VhZ2VNb2RlbFNwZWNpZmljYXRpb25TY2hlbWEgPSB6NC5vYmplY3Qoe1xuICBzcGVjaWZpY2F0aW9uVmVyc2lvbjogejQubGl0ZXJhbChcInYyXCIpLFxuICBwcm92aWRlcjogejQuc3RyaW5nKCksXG4gIG1vZGVsSWQ6IHo0LnN0cmluZygpXG59KTtcbnZhciBnYXRld2F5TGFuZ3VhZ2VNb2RlbFByaWNpbmdTY2hlbWEgPSB6NC5vYmplY3Qoe1xuICBpbnB1dDogejQuc3RyaW5nKCksXG4gIG91dHB1dDogejQuc3RyaW5nKCksXG4gIGlucHV0X2NhY2hlX3JlYWQ6IHo0LnN0cmluZygpLm51bGxpc2goKSxcbiAgaW5wdXRfY2FjaGVfd3JpdGU6IHo0LnN0cmluZygpLm51bGxpc2goKVxufSkudHJhbnNmb3JtKCh7IGlucHV0LCBvdXRwdXQsIGlucHV0X2NhY2hlX3JlYWQsIGlucHV0X2NhY2hlX3dyaXRlIH0pID0+ICh7XG4gIGlucHV0LFxuICBvdXRwdXQsXG4gIC4uLmlucHV0X2NhY2hlX3JlYWQgPyB7IGNhY2hlZElucHV0VG9rZW5zOiBpbnB1dF9jYWNoZV9yZWFkIH0gOiB7fSxcbiAgLi4uaW5wdXRfY2FjaGVfd3JpdGUgPyB7IGNhY2hlQ3JlYXRpb25JbnB1dFRva2VuczogaW5wdXRfY2FjaGVfd3JpdGUgfSA6IHt9XG59KSk7XG52YXIgZ2F0ZXdheUxhbmd1YWdlTW9kZWxFbnRyeVNjaGVtYSA9IHo0Lm9iamVjdCh7XG4gIGlkOiB6NC5zdHJpbmcoKSxcbiAgbmFtZTogejQuc3RyaW5nKCksXG4gIGRlc2NyaXB0aW9uOiB6NC5zdHJpbmcoKS5udWxsaXNoKCksXG4gIHByaWNpbmc6IGdhdGV3YXlMYW5ndWFnZU1vZGVsUHJpY2luZ1NjaGVtYS5udWxsaXNoKCksXG4gIHNwZWNpZmljYXRpb246IGdhdGV3YXlMYW5ndWFnZU1vZGVsU3BlY2lmaWNhdGlvblNjaGVtYSxcbiAgbW9kZWxUeXBlOiB6NC5lbnVtKFtcImxhbmd1YWdlXCIsIFwiZW1iZWRkaW5nXCIsIFwiaW1hZ2VcIl0pLm51bGxpc2goKVxufSk7XG52YXIgZ2F0ZXdheUZldGNoTWV0YWRhdGFTY2hlbWEgPSB6NC5vYmplY3Qoe1xuICBtb2RlbHM6IHo0LmFycmF5KGdhdGV3YXlMYW5ndWFnZU1vZGVsRW50cnlTY2hlbWEpXG59KTtcblxuLy8gc3JjL2dhdGV3YXktbGFuZ3VhZ2UtbW9kZWwudHNcbmltcG9ydCB7XG4gIGNvbWJpbmVIZWFkZXJzLFxuICBjcmVhdGVFdmVudFNvdXJjZVJlc3BvbnNlSGFuZGxlcixcbiAgY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyIGFzIGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlcjIsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIgYXMgY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcjIsXG4gIHBvc3RKc29uVG9BcGksXG4gIHJlc29sdmUgYXMgcmVzb2x2ZTJcbn0gZnJvbSBcIkBhaS1zZGsvcHJvdmlkZXItdXRpbHNcIjtcbmltcG9ydCB7IHogYXMgejUgfSBmcm9tIFwiem9kL3Y0XCI7XG52YXIgR2F0ZXdheUxhbmd1YWdlTW9kZWwgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKG1vZGVsSWQsIGNvbmZpZykge1xuICAgIHRoaXMubW9kZWxJZCA9IG1vZGVsSWQ7XG4gICAgdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5zcGVjaWZpY2F0aW9uVmVyc2lvbiA9IFwidjJcIjtcbiAgICB0aGlzLnN1cHBvcnRlZFVybHMgPSB7IFwiKi8qXCI6IFsvLiovXSB9O1xuICB9XG4gIGdldCBwcm92aWRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWcucHJvdmlkZXI7XG4gIH1cbiAgYXN5bmMgZ2V0QXJncyhvcHRpb25zKSB7XG4gICAgY29uc3QgeyBhYm9ydFNpZ25hbDogX2Fib3J0U2lnbmFsLCAuLi5vcHRpb25zV2l0aG91dFNpZ25hbCB9ID0gb3B0aW9ucztcbiAgICByZXR1cm4ge1xuICAgICAgYXJnczogdGhpcy5tYXliZUVuY29kZUZpbGVQYXJ0cyhvcHRpb25zV2l0aG91dFNpZ25hbCksXG4gICAgICB3YXJuaW5nczogW11cbiAgICB9O1xuICB9XG4gIGFzeW5jIGRvR2VuZXJhdGUob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYXJncywgd2FybmluZ3MgfSA9IGF3YWl0IHRoaXMuZ2V0QXJncyhvcHRpb25zKTtcbiAgICBjb25zdCB7IGFib3J0U2lnbmFsIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHJlc29sdmVkSGVhZGVycyA9IGF3YWl0IHJlc29sdmUyKHRoaXMuY29uZmlnLmhlYWRlcnMoKSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICB2YWx1ZTogcmVzcG9uc2VCb2R5LFxuICAgICAgICByYXdWYWx1ZTogcmF3UmVzcG9uc2VcbiAgICAgIH0gPSBhd2FpdCBwb3N0SnNvblRvQXBpKHtcbiAgICAgICAgdXJsOiB0aGlzLmdldFVybCgpLFxuICAgICAgICBoZWFkZXJzOiBjb21iaW5lSGVhZGVycyhcbiAgICAgICAgICByZXNvbHZlZEhlYWRlcnMsXG4gICAgICAgICAgb3B0aW9ucy5oZWFkZXJzLFxuICAgICAgICAgIHRoaXMuZ2V0TW9kZWxDb25maWdIZWFkZXJzKHRoaXMubW9kZWxJZCwgZmFsc2UpLFxuICAgICAgICAgIGF3YWl0IHJlc29sdmUyKHRoaXMuY29uZmlnLm8xMXlIZWFkZXJzKVxuICAgICAgICApLFxuICAgICAgICBib2R5OiBhcmdzLFxuICAgICAgICBzdWNjZXNzZnVsUmVzcG9uc2VIYW5kbGVyOiBjcmVhdGVKc29uUmVzcG9uc2VIYW5kbGVyMih6NS5hbnkoKSksXG4gICAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyMih7XG4gICAgICAgICAgZXJyb3JTY2hlbWE6IHo1LmFueSgpLFxuICAgICAgICAgIGVycm9yVG9NZXNzYWdlOiAoZGF0YSkgPT4gZGF0YVxuICAgICAgICB9KSxcbiAgICAgICAgLi4uYWJvcnRTaWduYWwgJiYgeyBhYm9ydFNpZ25hbCB9LFxuICAgICAgICBmZXRjaDogdGhpcy5jb25maWcuZmV0Y2hcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ucmVzcG9uc2VCb2R5LFxuICAgICAgICByZXF1ZXN0OiB7IGJvZHk6IGFyZ3MgfSxcbiAgICAgICAgcmVzcG9uc2U6IHsgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzLCBib2R5OiByYXdSZXNwb25zZSB9LFxuICAgICAgICB3YXJuaW5nc1xuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgYXNHYXRld2F5RXJyb3IoZXJyb3IsIHBhcnNlQXV0aE1ldGhvZChyZXNvbHZlZEhlYWRlcnMpKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgZG9TdHJlYW0ob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYXJncywgd2FybmluZ3MgfSA9IGF3YWl0IHRoaXMuZ2V0QXJncyhvcHRpb25zKTtcbiAgICBjb25zdCB7IGFib3J0U2lnbmFsIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHJlc29sdmVkSGVhZGVycyA9IGF3YWl0IHJlc29sdmUyKHRoaXMuY29uZmlnLmhlYWRlcnMoKSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgdmFsdWU6IHJlc3BvbnNlLCByZXNwb25zZUhlYWRlcnMgfSA9IGF3YWl0IHBvc3RKc29uVG9BcGkoe1xuICAgICAgICB1cmw6IHRoaXMuZ2V0VXJsKCksXG4gICAgICAgIGhlYWRlcnM6IGNvbWJpbmVIZWFkZXJzKFxuICAgICAgICAgIHJlc29sdmVkSGVhZGVycyxcbiAgICAgICAgICBvcHRpb25zLmhlYWRlcnMsXG4gICAgICAgICAgdGhpcy5nZXRNb2RlbENvbmZpZ0hlYWRlcnModGhpcy5tb2RlbElkLCB0cnVlKSxcbiAgICAgICAgICBhd2FpdCByZXNvbHZlMih0aGlzLmNvbmZpZy5vMTF5SGVhZGVycylcbiAgICAgICAgKSxcbiAgICAgICAgYm9keTogYXJncyxcbiAgICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlRXZlbnRTb3VyY2VSZXNwb25zZUhhbmRsZXIoejUuYW55KCkpLFxuICAgICAgICBmYWlsZWRSZXNwb25zZUhhbmRsZXI6IGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlcjIoe1xuICAgICAgICAgIGVycm9yU2NoZW1hOiB6NS5hbnkoKSxcbiAgICAgICAgICBlcnJvclRvTWVzc2FnZTogKGRhdGEpID0+IGRhdGFcbiAgICAgICAgfSksXG4gICAgICAgIC4uLmFib3J0U2lnbmFsICYmIHsgYWJvcnRTaWduYWwgfSxcbiAgICAgICAgZmV0Y2g6IHRoaXMuY29uZmlnLmZldGNoXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0cmVhbTogcmVzcG9uc2UucGlwZVRocm91Z2goXG4gICAgICAgICAgbmV3IFRyYW5zZm9ybVN0cmVhbSh7XG4gICAgICAgICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgIGlmICh3YXJuaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHsgdHlwZTogXCJzdHJlYW0tc3RhcnRcIiwgd2FybmluZ3MgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0cmFuc2Zvcm0oY2h1bmssIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgaWYgKGNodW5rLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdHJlYW1QYXJ0ID0gY2h1bmsudmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbVBhcnQudHlwZSA9PT0gXCJyYXdcIiAmJiAhb3B0aW9ucy5pbmNsdWRlUmF3Q2h1bmtzKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1QYXJ0LnR5cGUgPT09IFwicmVzcG9uc2UtbWV0YWRhdGFcIiAmJiBzdHJlYW1QYXJ0LnRpbWVzdGFtcCAmJiB0eXBlb2Ygc3RyZWFtUGFydC50aW1lc3RhbXAgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgIHN0cmVhbVBhcnQudGltZXN0YW1wID0gbmV3IERhdGUoc3RyZWFtUGFydC50aW1lc3RhbXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoc3RyZWFtUGFydCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lcnJvcihcbiAgICAgICAgICAgICAgICAgIGNodW5rLmVycm9yXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgICksXG4gICAgICAgIHJlcXVlc3Q6IHsgYm9keTogYXJncyB9LFxuICAgICAgICByZXNwb25zZTogeyBoZWFkZXJzOiByZXNwb25zZUhlYWRlcnMgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgYXNHYXRld2F5RXJyb3IoZXJyb3IsIHBhcnNlQXV0aE1ldGhvZChyZXNvbHZlZEhlYWRlcnMpKTtcbiAgICB9XG4gIH1cbiAgaXNGaWxlUGFydChwYXJ0KSB7XG4gICAgcmV0dXJuIHBhcnQgJiYgdHlwZW9mIHBhcnQgPT09IFwib2JqZWN0XCIgJiYgXCJ0eXBlXCIgaW4gcGFydCAmJiBwYXJ0LnR5cGUgPT09IFwiZmlsZVwiO1xuICB9XG4gIC8qKlxuICAgKiBFbmNvZGVzIGZpbGUgcGFydHMgaW4gdGhlIHByb21wdCB0byBiYXNlNjQuIE11dGF0ZXMgdGhlIHBhc3NlZCBvcHRpb25zXG4gICAqIGluc3RhbmNlIGRpcmVjdGx5IHRvIGF2b2lkIGNvcHlpbmcgdGhlIGZpbGUgZGF0YS5cbiAgICogQHBhcmFtIG9wdGlvbnMgLSBUaGUgb3B0aW9ucyB0byBlbmNvZGUuXG4gICAqIEByZXR1cm5zIFRoZSBvcHRpb25zIHdpdGggdGhlIGZpbGUgcGFydHMgZW5jb2RlZC5cbiAgICovXG4gIG1heWJlRW5jb2RlRmlsZVBhcnRzKG9wdGlvbnMpIHtcbiAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2Ygb3B0aW9ucy5wcm9tcHQpIHtcbiAgICAgIGZvciAoY29uc3QgcGFydCBvZiBtZXNzYWdlLmNvbnRlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNGaWxlUGFydChwYXJ0KSkge1xuICAgICAgICAgIGNvbnN0IGZpbGVQYXJ0ID0gcGFydDtcbiAgICAgICAgICBpZiAoZmlsZVBhcnQuZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IFVpbnQ4QXJyYXkuZnJvbShmaWxlUGFydC5kYXRhKTtcbiAgICAgICAgICAgIGNvbnN0IGJhc2U2NERhdGEgPSBCdWZmZXIuZnJvbShidWZmZXIpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuICAgICAgICAgICAgZmlsZVBhcnQuZGF0YSA9IG5ldyBVUkwoXG4gICAgICAgICAgICAgIGBkYXRhOiR7ZmlsZVBhcnQubWVkaWFUeXBlIHx8IFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCJ9O2Jhc2U2NCwke2Jhc2U2NERhdGF9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH1cbiAgZ2V0VXJsKCkge1xuICAgIHJldHVybiBgJHt0aGlzLmNvbmZpZy5iYXNlVVJMfS9sYW5ndWFnZS1tb2RlbGA7XG4gIH1cbiAgZ2V0TW9kZWxDb25maWdIZWFkZXJzKG1vZGVsSWQsIHN0cmVhbWluZykge1xuICAgIHJldHVybiB7XG4gICAgICBcImFpLWxhbmd1YWdlLW1vZGVsLXNwZWNpZmljYXRpb24tdmVyc2lvblwiOiBcIjJcIixcbiAgICAgIFwiYWktbGFuZ3VhZ2UtbW9kZWwtaWRcIjogbW9kZWxJZCxcbiAgICAgIFwiYWktbGFuZ3VhZ2UtbW9kZWwtc3RyZWFtaW5nXCI6IFN0cmluZyhzdHJlYW1pbmcpXG4gICAgfTtcbiAgfVxufTtcblxuLy8gc3JjL2dhdGV3YXktZW1iZWRkaW5nLW1vZGVsLnRzXG5pbXBvcnQge1xuICBjb21iaW5lSGVhZGVycyBhcyBjb21iaW5lSGVhZGVyczIsXG4gIGNyZWF0ZUpzb25SZXNwb25zZUhhbmRsZXIgYXMgY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcjMsXG4gIGNyZWF0ZUpzb25FcnJvclJlc3BvbnNlSGFuZGxlciBhcyBjcmVhdGVKc29uRXJyb3JSZXNwb25zZUhhbmRsZXIzLFxuICBwb3N0SnNvblRvQXBpIGFzIHBvc3RKc29uVG9BcGkyLFxuICByZXNvbHZlIGFzIHJlc29sdmUzXG59IGZyb20gXCJAYWktc2RrL3Byb3ZpZGVyLXV0aWxzXCI7XG5pbXBvcnQgeyB6IGFzIHo2IH0gZnJvbSBcInpvZC92NFwiO1xudmFyIEdhdGV3YXlFbWJlZGRpbmdNb2RlbCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IobW9kZWxJZCwgY29uZmlnKSB7XG4gICAgdGhpcy5tb2RlbElkID0gbW9kZWxJZDtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICB0aGlzLnNwZWNpZmljYXRpb25WZXJzaW9uID0gXCJ2MlwiO1xuICAgIHRoaXMubWF4RW1iZWRkaW5nc1BlckNhbGwgPSAyMDQ4O1xuICAgIHRoaXMuc3VwcG9ydHNQYXJhbGxlbENhbGxzID0gdHJ1ZTtcbiAgfVxuICBnZXQgcHJvdmlkZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLnByb3ZpZGVyO1xuICB9XG4gIGFzeW5jIGRvRW1iZWQoe1xuICAgIHZhbHVlcyxcbiAgICBoZWFkZXJzLFxuICAgIGFib3J0U2lnbmFsLFxuICAgIHByb3ZpZGVyT3B0aW9uc1xuICB9KSB7XG4gICAgdmFyIF9hODtcbiAgICBjb25zdCByZXNvbHZlZEhlYWRlcnMgPSBhd2FpdCByZXNvbHZlMyh0aGlzLmNvbmZpZy5oZWFkZXJzKCkpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgdmFsdWU6IHJlc3BvbnNlQm9keSxcbiAgICAgICAgcmF3VmFsdWVcbiAgICAgIH0gPSBhd2FpdCBwb3N0SnNvblRvQXBpMih7XG4gICAgICAgIHVybDogdGhpcy5nZXRVcmwoKSxcbiAgICAgICAgaGVhZGVyczogY29tYmluZUhlYWRlcnMyKFxuICAgICAgICAgIHJlc29sdmVkSGVhZGVycyxcbiAgICAgICAgICBoZWFkZXJzICE9IG51bGwgPyBoZWFkZXJzIDoge30sXG4gICAgICAgICAgdGhpcy5nZXRNb2RlbENvbmZpZ0hlYWRlcnMoKSxcbiAgICAgICAgICBhd2FpdCByZXNvbHZlMyh0aGlzLmNvbmZpZy5vMTF5SGVhZGVycylcbiAgICAgICAgKSxcbiAgICAgICAgYm9keToge1xuICAgICAgICAgIGlucHV0OiB2YWx1ZXMubGVuZ3RoID09PSAxID8gdmFsdWVzWzBdIDogdmFsdWVzLFxuICAgICAgICAgIC4uLnByb3ZpZGVyT3B0aW9ucyAhPSBudWxsID8gcHJvdmlkZXJPcHRpb25zIDoge31cbiAgICAgICAgfSxcbiAgICAgICAgc3VjY2Vzc2Z1bFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvblJlc3BvbnNlSGFuZGxlcjMoXG4gICAgICAgICAgZ2F0ZXdheUVtYmVkZGluZ1Jlc3BvbnNlU2NoZW1hXG4gICAgICAgICksXG4gICAgICAgIGZhaWxlZFJlc3BvbnNlSGFuZGxlcjogY3JlYXRlSnNvbkVycm9yUmVzcG9uc2VIYW5kbGVyMyh7XG4gICAgICAgICAgZXJyb3JTY2hlbWE6IHo2LmFueSgpLFxuICAgICAgICAgIGVycm9yVG9NZXNzYWdlOiAoZGF0YSkgPT4gZGF0YVxuICAgICAgICB9KSxcbiAgICAgICAgLi4uYWJvcnRTaWduYWwgJiYgeyBhYm9ydFNpZ25hbCB9LFxuICAgICAgICBmZXRjaDogdGhpcy5jb25maWcuZmV0Y2hcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZW1iZWRkaW5nczogcmVzcG9uc2VCb2R5LmVtYmVkZGluZ3MsXG4gICAgICAgIHVzYWdlOiAoX2E4ID0gcmVzcG9uc2VCb2R5LnVzYWdlKSAhPSBudWxsID8gX2E4IDogdm9pZCAwLFxuICAgICAgICBwcm92aWRlck1ldGFkYXRhOiByZXNwb25zZUJvZHkucHJvdmlkZXJNZXRhZGF0YSxcbiAgICAgICAgcmVzcG9uc2U6IHsgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzLCBib2R5OiByYXdWYWx1ZSB9XG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBhc0dhdGV3YXlFcnJvcihlcnJvciwgcGFyc2VBdXRoTWV0aG9kKHJlc29sdmVkSGVhZGVycykpO1xuICAgIH1cbiAgfVxuICBnZXRVcmwoKSB7XG4gICAgcmV0dXJuIGAke3RoaXMuY29uZmlnLmJhc2VVUkx9L2VtYmVkZGluZy1tb2RlbGA7XG4gIH1cbiAgZ2V0TW9kZWxDb25maWdIZWFkZXJzKCkge1xuICAgIHJldHVybiB7XG4gICAgICBcImFpLWVtYmVkZGluZy1tb2RlbC1zcGVjaWZpY2F0aW9uLXZlcnNpb25cIjogXCIyXCIsXG4gICAgICBcImFpLW1vZGVsLWlkXCI6IHRoaXMubW9kZWxJZFxuICAgIH07XG4gIH1cbn07XG52YXIgZ2F0ZXdheUVtYmVkZGluZ1Jlc3BvbnNlU2NoZW1hID0gejYub2JqZWN0KHtcbiAgZW1iZWRkaW5nczogejYuYXJyYXkoejYuYXJyYXkoejYubnVtYmVyKCkpKSxcbiAgdXNhZ2U6IHo2Lm9iamVjdCh7IHRva2VuczogejYubnVtYmVyKCkgfSkubnVsbGlzaCgpLFxuICBwcm92aWRlck1ldGFkYXRhOiB6Ni5yZWNvcmQoejYuc3RyaW5nKCksIHo2LnJlY29yZCh6Ni5zdHJpbmcoKSwgejYudW5rbm93bigpKSkub3B0aW9uYWwoKVxufSk7XG5cbi8vIHNyYy92ZXJjZWwtZW52aXJvbm1lbnQudHNcbmFzeW5jIGZ1bmN0aW9uIGdldFZlcmNlbE9pZGNUb2tlbigpIHtcbiAgdmFyIF9hOCwgX2I4O1xuICBjb25zdCB0b2tlbiA9IChfYjggPSAoX2E4ID0gZ2V0Q29udGV4dCgpLmhlYWRlcnMpID09IG51bGwgPyB2b2lkIDAgOiBfYThbXCJ4LXZlcmNlbC1vaWRjLXRva2VuXCJdKSAhPSBudWxsID8gX2I4IDogcHJvY2Vzcy5lbnYuVkVSQ0VMX09JRENfVE9LRU47XG4gIGlmICghdG9rZW4pIHtcbiAgICB0aHJvdyBuZXcgR2F0ZXdheUF1dGhlbnRpY2F0aW9uRXJyb3Ioe1xuICAgICAgbWVzc2FnZTogXCJPSURDIHRva2VuIG5vdCBhdmFpbGFibGVcIixcbiAgICAgIHN0YXR1c0NvZGU6IDQwMVxuICAgIH0pO1xuICB9XG4gIHJldHVybiB0b2tlbjtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldFZlcmNlbFJlcXVlc3RJZCgpIHtcbiAgdmFyIF9hODtcbiAgcmV0dXJuIChfYTggPSBnZXRDb250ZXh0KCkuaGVhZGVycykgPT0gbnVsbCA/IHZvaWQgMCA6IF9hOFtcIngtdmVyY2VsLWlkXCJdO1xufVxudmFyIFNZTUJPTF9GT1JfUkVRX0NPTlRFWFQgPSBTeW1ib2wuZm9yKFwiQHZlcmNlbC9yZXF1ZXN0LWNvbnRleHRcIik7XG5mdW5jdGlvbiBnZXRDb250ZXh0KCkge1xuICB2YXIgX2E4LCBfYjgsIF9jO1xuICBjb25zdCBmcm9tU3ltYm9sID0gZ2xvYmFsVGhpcztcbiAgcmV0dXJuIChfYyA9IChfYjggPSAoX2E4ID0gZnJvbVN5bWJvbFtTWU1CT0xfRk9SX1JFUV9DT05URVhUXSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hOC5nZXQpID09IG51bGwgPyB2b2lkIDAgOiBfYjguY2FsbChfYTgpKSAhPSBudWxsID8gX2MgOiB7fTtcbn1cblxuLy8gc3JjL2dhdGV3YXktcHJvdmlkZXIudHNcbnZhciBBSV9HQVRFV0FZX1BST1RPQ09MX1ZFUlNJT04gPSBcIjAuMC4xXCI7XG5mdW5jdGlvbiBjcmVhdGVHYXRld2F5UHJvdmlkZXIob3B0aW9ucyA9IHt9KSB7XG4gIHZhciBfYTgsIF9iODtcbiAgbGV0IHBlbmRpbmdNZXRhZGF0YSA9IG51bGw7XG4gIGxldCBtZXRhZGF0YUNhY2hlID0gbnVsbDtcbiAgY29uc3QgY2FjaGVSZWZyZXNoTWlsbGlzID0gKF9hOCA9IG9wdGlvbnMubWV0YWRhdGFDYWNoZVJlZnJlc2hNaWxsaXMpICE9IG51bGwgPyBfYTggOiAxZTMgKiA2MCAqIDU7XG4gIGxldCBsYXN0RmV0Y2hUaW1lID0gMDtcbiAgY29uc3QgYmFzZVVSTCA9IChfYjggPSB3aXRob3V0VHJhaWxpbmdTbGFzaChvcHRpb25zLmJhc2VVUkwpKSAhPSBudWxsID8gX2I4IDogXCJodHRwczovL2FpLWdhdGV3YXkudmVyY2VsLnNoL3YxL2FpXCI7XG4gIGNvbnN0IGdldEhlYWRlcnMgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgYXV0aCA9IGF3YWl0IGdldEdhdGV3YXlBdXRoVG9rZW4ob3B0aW9ucyk7XG4gICAgaWYgKGF1dGgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHthdXRoLnRva2VufWAsXG4gICAgICAgIFwiYWktZ2F0ZXdheS1wcm90b2NvbC12ZXJzaW9uXCI6IEFJX0dBVEVXQVlfUFJPVE9DT0xfVkVSU0lPTixcbiAgICAgICAgW0dBVEVXQVlfQVVUSF9NRVRIT0RfSEVBREVSXTogYXV0aC5hdXRoTWV0aG9kLFxuICAgICAgICAuLi5vcHRpb25zLmhlYWRlcnNcbiAgICAgIH07XG4gICAgfVxuICAgIHRocm93IEdhdGV3YXlBdXRoZW50aWNhdGlvbkVycm9yLmNyZWF0ZUNvbnRleHR1YWxFcnJvcih7XG4gICAgICBhcGlLZXlQcm92aWRlZDogZmFsc2UsXG4gICAgICBvaWRjVG9rZW5Qcm92aWRlZDogZmFsc2UsXG4gICAgICBzdGF0dXNDb2RlOiA0MDFcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgY3JlYXRlTzExeUhlYWRlcnMgPSAoKSA9PiB7XG4gICAgY29uc3QgZGVwbG95bWVudElkID0gbG9hZE9wdGlvbmFsU2V0dGluZyh7XG4gICAgICBzZXR0aW5nVmFsdWU6IHZvaWQgMCxcbiAgICAgIGVudmlyb25tZW50VmFyaWFibGVOYW1lOiBcIlZFUkNFTF9ERVBMT1lNRU5UX0lEXCJcbiAgICB9KTtcbiAgICBjb25zdCBlbnZpcm9ubWVudCA9IGxvYWRPcHRpb25hbFNldHRpbmcoe1xuICAgICAgc2V0dGluZ1ZhbHVlOiB2b2lkIDAsXG4gICAgICBlbnZpcm9ubWVudFZhcmlhYmxlTmFtZTogXCJWRVJDRUxfRU5WXCJcbiAgICB9KTtcbiAgICBjb25zdCByZWdpb24gPSBsb2FkT3B0aW9uYWxTZXR0aW5nKHtcbiAgICAgIHNldHRpbmdWYWx1ZTogdm9pZCAwLFxuICAgICAgZW52aXJvbm1lbnRWYXJpYWJsZU5hbWU6IFwiVkVSQ0VMX1JFR0lPTlwiXG4gICAgfSk7XG4gICAgcmV0dXJuIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlcXVlc3RJZCA9IGF3YWl0IGdldFZlcmNlbFJlcXVlc3RJZCgpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uZGVwbG95bWVudElkICYmIHsgXCJhaS1vMTF5LWRlcGxveW1lbnQtaWRcIjogZGVwbG95bWVudElkIH0sXG4gICAgICAgIC4uLmVudmlyb25tZW50ICYmIHsgXCJhaS1vMTF5LWVudmlyb25tZW50XCI6IGVudmlyb25tZW50IH0sXG4gICAgICAgIC4uLnJlZ2lvbiAmJiB7IFwiYWktbzExeS1yZWdpb25cIjogcmVnaW9uIH0sXG4gICAgICAgIC4uLnJlcXVlc3RJZCAmJiB7IFwiYWktbzExeS1yZXF1ZXN0LWlkXCI6IHJlcXVlc3RJZCB9XG4gICAgICB9O1xuICAgIH07XG4gIH07XG4gIGNvbnN0IGNyZWF0ZUxhbmd1YWdlTW9kZWwgPSAobW9kZWxJZCkgPT4ge1xuICAgIHJldHVybiBuZXcgR2F0ZXdheUxhbmd1YWdlTW9kZWwobW9kZWxJZCwge1xuICAgICAgcHJvdmlkZXI6IFwiZ2F0ZXdheVwiLFxuICAgICAgYmFzZVVSTCxcbiAgICAgIGhlYWRlcnM6IGdldEhlYWRlcnMsXG4gICAgICBmZXRjaDogb3B0aW9ucy5mZXRjaCxcbiAgICAgIG8xMXlIZWFkZXJzOiBjcmVhdGVPMTF5SGVhZGVycygpXG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGdldEF2YWlsYWJsZU1vZGVscyA9IGFzeW5jICgpID0+IHtcbiAgICB2YXIgX2E5LCBfYjksIF9jO1xuICAgIGNvbnN0IG5vdyA9IChfYyA9IChfYjkgPSAoX2E5ID0gb3B0aW9ucy5faW50ZXJuYWwpID09IG51bGwgPyB2b2lkIDAgOiBfYTkuY3VycmVudERhdGUpID09IG51bGwgPyB2b2lkIDAgOiBfYjkuY2FsbChfYTkpLmdldFRpbWUoKSkgIT0gbnVsbCA/IF9jIDogRGF0ZS5ub3coKTtcbiAgICBpZiAoIXBlbmRpbmdNZXRhZGF0YSB8fCBub3cgLSBsYXN0RmV0Y2hUaW1lID4gY2FjaGVSZWZyZXNoTWlsbGlzKSB7XG4gICAgICBsYXN0RmV0Y2hUaW1lID0gbm93O1xuICAgICAgcGVuZGluZ01ldGFkYXRhID0gbmV3IEdhdGV3YXlGZXRjaE1ldGFkYXRhKHtcbiAgICAgICAgYmFzZVVSTCxcbiAgICAgICAgaGVhZGVyczogZ2V0SGVhZGVycyxcbiAgICAgICAgZmV0Y2g6IG9wdGlvbnMuZmV0Y2hcbiAgICAgIH0pLmdldEF2YWlsYWJsZU1vZGVscygpLnRoZW4oKG1ldGFkYXRhKSA9PiB7XG4gICAgICAgIG1ldGFkYXRhQ2FjaGUgPSBtZXRhZGF0YTtcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xuICAgICAgfSkuY2F0Y2goYXN5bmMgKGVycm9yKSA9PiB7XG4gICAgICAgIHRocm93IGFzR2F0ZXdheUVycm9yKGVycm9yLCBwYXJzZUF1dGhNZXRob2QoYXdhaXQgZ2V0SGVhZGVycygpKSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG1ldGFkYXRhQ2FjaGUgPyBQcm9taXNlLnJlc29sdmUobWV0YWRhdGFDYWNoZSkgOiBwZW5kaW5nTWV0YWRhdGE7XG4gIH07XG4gIGNvbnN0IHByb3ZpZGVyID0gZnVuY3Rpb24obW9kZWxJZCkge1xuICAgIGlmIChuZXcudGFyZ2V0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIFwiVGhlIEdhdGV3YXkgUHJvdmlkZXIgbW9kZWwgZnVuY3Rpb24gY2Fubm90IGJlIGNhbGxlZCB3aXRoIHRoZSBuZXcga2V5d29yZC5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNyZWF0ZUxhbmd1YWdlTW9kZWwobW9kZWxJZCk7XG4gIH07XG4gIHByb3ZpZGVyLmdldEF2YWlsYWJsZU1vZGVscyA9IGdldEF2YWlsYWJsZU1vZGVscztcbiAgcHJvdmlkZXIuaW1hZ2VNb2RlbCA9IChtb2RlbElkKSA9PiB7XG4gICAgdGhyb3cgbmV3IE5vU3VjaE1vZGVsRXJyb3IoeyBtb2RlbElkLCBtb2RlbFR5cGU6IFwiaW1hZ2VNb2RlbFwiIH0pO1xuICB9O1xuICBwcm92aWRlci5sYW5ndWFnZU1vZGVsID0gY3JlYXRlTGFuZ3VhZ2VNb2RlbDtcbiAgcHJvdmlkZXIudGV4dEVtYmVkZGluZ01vZGVsID0gKG1vZGVsSWQpID0+IHtcbiAgICByZXR1cm4gbmV3IEdhdGV3YXlFbWJlZGRpbmdNb2RlbChtb2RlbElkLCB7XG4gICAgICBwcm92aWRlcjogXCJnYXRld2F5XCIsXG4gICAgICBiYXNlVVJMLFxuICAgICAgaGVhZGVyczogZ2V0SGVhZGVycyxcbiAgICAgIGZldGNoOiBvcHRpb25zLmZldGNoLFxuICAgICAgbzExeUhlYWRlcnM6IGNyZWF0ZU8xMXlIZWFkZXJzKClcbiAgICB9KTtcbiAgfTtcbiAgcmV0dXJuIHByb3ZpZGVyO1xufVxudmFyIGdhdGV3YXkgPSBjcmVhdGVHYXRld2F5UHJvdmlkZXIoKTtcbmFzeW5jIGZ1bmN0aW9uIGdldEdhdGV3YXlBdXRoVG9rZW4ob3B0aW9ucykge1xuICBjb25zdCBhcGlLZXkgPSBsb2FkT3B0aW9uYWxTZXR0aW5nKHtcbiAgICBzZXR0aW5nVmFsdWU6IG9wdGlvbnMuYXBpS2V5LFxuICAgIGVudmlyb25tZW50VmFyaWFibGVOYW1lOiBcIkFJX0dBVEVXQVlfQVBJX0tFWVwiXG4gIH0pO1xuICBpZiAoYXBpS2V5KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRva2VuOiBhcGlLZXksXG4gICAgICBhdXRoTWV0aG9kOiBcImFwaS1rZXlcIlxuICAgIH07XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCBvaWRjVG9rZW4gPSBhd2FpdCBnZXRWZXJjZWxPaWRjVG9rZW4oKTtcbiAgICByZXR1cm4ge1xuICAgICAgdG9rZW46IG9pZGNUb2tlbixcbiAgICAgIGF1dGhNZXRob2Q6IFwib2lkY1wiXG4gICAgfTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5leHBvcnQge1xuICBHYXRld2F5QXV0aGVudGljYXRpb25FcnJvcixcbiAgR2F0ZXdheUVycm9yLFxuICBHYXRld2F5SW50ZXJuYWxTZXJ2ZXJFcnJvcixcbiAgR2F0ZXdheUludmFsaWRSZXF1ZXN0RXJyb3IsXG4gIEdhdGV3YXlNb2RlbE5vdEZvdW5kRXJyb3IsXG4gIEdhdGV3YXlSYXRlTGltaXRFcnJvcixcbiAgR2F0ZXdheVJlc3BvbnNlRXJyb3IsXG4gIGNyZWF0ZUdhdGV3YXlQcm92aWRlciBhcyBjcmVhdGVHYXRld2F5LFxuICBjcmVhdGVHYXRld2F5UHJvdmlkZXIsXG4gIGdhdGV3YXlcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@ai-sdk+gateway@1.0.15_zod@4.1.5/node_modules/@ai-sdk/gateway/dist/index.mjs\n");

/***/ })

};
;